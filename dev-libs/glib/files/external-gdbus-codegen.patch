From 368d34fc06c4472a2240ccbe7f0669c7c51a2acd Mon Sep 17 00:00:00 2001
From: Marc-Antoine Perennou <Marc-Antoine@Perennou.com>
Date: Fri, 26 Aug 2011 12:08:09 +0200
Subject: [PATCH] external gdbus-codegen

Signed-off-by: Marc-Antoine Perennou <Marc-Antoine@Perennou.com>
---
 configure.ac                                       |    4 +---
 docs/reference/gio/Makefile.am                     |    3 +--
 gio/Makefile.am                                    |    2 +-
 gio/tests/Makefile.am                              |    6 ++----
 gio/tests/gdbus-object-manager-example/Makefile.am |    6 ++----
 5 files changed, 7 insertions(+), 14 deletions(-)

diff --git a/configure.ac b/configure.ac
index e4235e0..f957b50 100644
--- a/configure.ac
+++ b/configure.ac
@@ -358,7 +358,7 @@ fi
 AC_SUBST(PERL_PATH)
 
 # Need suitable python path for greport
-AM_PATH_PYTHON(2.5,,PYTHON="/usr/bin/env python2.5")
+# AM_PATH_PYTHON(2.5,,PYTHON="/usr/bin/env python2.5")
 
 
 dnl ***********************
@@ -3642,8 +3642,6 @@ gobject/tests/Makefile
 gthread/Makefile
 gthread/tests/Makefile
 gio/Makefile
-gio/gdbus-2.0/codegen/Makefile
-gio/gdbus-2.0/codegen/config.py
 gio/xdgmime/Makefile
 gio/inotify/Makefile
 gio/fen/Makefile
diff --git a/docs/reference/gio/Makefile.am b/docs/reference/gio/Makefile.am
index 96dcadb..c7eece6 100644
--- a/docs/reference/gio/Makefile.am
+++ b/docs/reference/gio/Makefile.am
@@ -138,8 +138,7 @@ man_MANS =			\
 	gio-querymodules.1	\
 	glib-compile-schemas.1	\
 	gsettings.1		\
-	gdbus.1			\
-	gdbus-codegen.1
+	gdbus.1
 
 if ENABLE_MAN
 
diff --git a/gio/Makefile.am b/gio/Makefile.am
index 698fa92..00fc32e 100644
--- a/gio/Makefile.am
+++ b/gio/Makefile.am
@@ -2,7 +2,7 @@ include $(top_srcdir)/Makefile.decl
 
 NULL =
 
-SUBDIRS = gdbus-2.0/codegen
+SUBDIRS =
 
 if OS_UNIX
 SUBDIRS += xdgmime
diff --git a/gio/tests/Makefile.am b/gio/tests/Makefile.am
index e354528..1a363ad 100644
--- a/gio/tests/Makefile.am
+++ b/gio/tests/Makefile.am
@@ -268,10 +268,8 @@ gdbus_close_pending_SOURCES = gdbus-close-pending.c gdbus-sessionbus.c gdbus-ses
 gdbus_close_pending_LDADD = $(progs_ldadd)
 
 if OS_UNIX
-gdbus-test-codegen-generated.h gdbus-test-codegen-generated.c : test-codegen.xml Makefile $(top_builddir)/gio/gdbus-2.0/codegen/gdbus-codegen
-	$(AM_V_GEN) UNINSTALLED_GLIB_SRCDIR=$(top_srcdir) \
-		UNINSTALLED_GLIB_BUILDDIR=$(top_builddir) \
-		$(PYTHON) $(top_builddir)/gio/gdbus-2.0/codegen/gdbus-codegen \
+gdbus-test-codegen-generated.h gdbus-test-codegen-generated.c : test-codegen.xml Makefile
+	$(AM_V_GEN) gdbus-codegen \
 		--interface-prefix org.project. \
 		--generate-c-code gdbus-test-codegen-generated \
 		--c-generate-object-manager \
diff --git a/gio/tests/gdbus-object-manager-example/Makefile.am b/gio/tests/gdbus-object-manager-example/Makefile.am
index 9861d0e..9ca6eb9 100644
--- a/gio/tests/gdbus-object-manager-example/Makefile.am
+++ b/gio/tests/gdbus-object-manager-example/Makefile.am
@@ -21,10 +21,8 @@ GDBUS_GENERATED = 										\
 	gdbus-example-objectmanager-generated-org.gtk.GDBus.Example.ObjectManager.Cat.xml 	\
 	$(NULL)
 
-$(GDBUS_GENERATED) : gdbus-example-objectmanager.xml Makefile $(top_builddir)/gio/gdbus-2.0/codegen/gdbus-codegen
-	$(AM_V_GEN) UNINSTALLED_GLIB_SRCDIR=$(top_srcdir) \
-		UNINSTALLED_GLIB_BUILDDIR=$(top_builddir) \
-		$(PYTHON) $(top_builddir)/gio/gdbus-2.0/codegen/gdbus-codegen \
+$(GDBUS_GENERATED) : gdbus-example-objectmanager.xml Makefile
+	$(AM_V_GEN) gdbus-codegen \
 		--interface-prefix org.gtk.GDBus.Example.ObjectManager. \
 		--c-namespace Example \
 		--c-generate-object-manager \
-- 
1.7.7.138.g7f41b6.dirty

